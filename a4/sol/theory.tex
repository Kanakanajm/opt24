\documentclass{article}

% Packages forked from the original template
\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}

% Extra packages
\usepackage{changepage} % adjustwidth environment
\usepackage{hyperref} % href
\usepackage{xcolor} % colored text

\usetikzlibrary{automata,positioning}

% Additional commands
\def\eg{\emph{e.g., }}
\def\ie{\emph{i.e., }}
\def\cf{\emph{c.f., }}
\def\etc{\emph{etc. }}
\def\wrt{\emph{w.r.t. }}
\def\etal{\emph{et al. }}

%
% Basic Document Settings
%

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1}

\pagestyle{fancy}
\lhead{\hmwkClass: \hmwkTitle}
\rhead{\firstxmark}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\setlength\parindent{0pt}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
\nobreak\extramarks{}{Exercise \arabic{#1} continued on next page\ldots}\nobreak{}
\nobreak\extramarks{Exercise \arabic{#1} (continued)}{Exercise \arabic{#1} continued on next page\ldots}\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
\nobreak\extramarks{Exercise \arabic{#1} (continued)}{Exercise \arabic{#1} continued on next page\ldots}\nobreak{}
\stepcounter{#1}
\nobreak\extramarks{Exercise \arabic{#1}}{}\nobreak{}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}
\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Exercise \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
\ifnum#1>0
\setcounter{homeworkProblemCounter}{#1}
\fi
\section{Exercise \arabic{homeworkProblemCounter}}
\setcounter{partCounter}{1}
\enterProblemHeader{homeworkProblemCounter}
}{
\exitProblemHeader{homeworkProblemCounter}
}

%
% Homework Details
%   - Title
%   - Due date
%   - Class
%   - Section/Time
%   - Instructor
%   - Author
%

\newcommand{\hmwkTitle}{Assignment 4}
\newcommand{\hmwkDueDate}{May 21, 2024}
\newcommand{\hmwkClass}{Continuous Optimization}
\newcommand{\hmwkAuthorName}{ \textbf{Honglu Ma} \and \textbf{Hiroyasu Akada} \and \textbf{Mathivathana Ayyappan}}

%
% Title Page
%

\title{
\vspace{2in}
\textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
\normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate}\\
\vspace{3in}
}

\author{\hmwkAuthorName}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

%
% Various Helper Commands
%

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% For derivatives
\newcommand{\deriv}[1]{\frac{\mathrm{d}}{\mathrm{d}x} (#1)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial #1} (#2)}

% Integral dx
\newcommand{\dx}{\mathrm{d}x}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}

% Probability commands: Expectation, Variance, Covariance, Bias
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Bias}{\mathrm{Bias}}

% Norm
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

% Margined Homework Subsection
\newenvironment{homeworkSubsection}[1]{%
\subsection*{#1}%
\begin{adjustwidth}{2.5em}{0pt}%
    }{%
\end{adjustwidth}%
}

\begin{document}

\maketitle

\pagebreak
\begin{homeworkProblem}[1]
    The objective function can be rewritten as:
    \[
        f(x) = \langle x, Qx\rangle
    \]
    where
    \[
        Q = \begin{pmatrix}
            4 & -1\\
            -1 & 1\\
        \end{pmatrix}
    \]
    We can obtain $\tau_0$ by exact line search i.e. solving the following equation:
    \begin{align*}
        \frac{\partial f(x_0 + \tau_0 k_0)}{\partial \tau_0} &= 0\\
        \langle d_0, \nabla f(x_0 + \tau_0 d_0)\rangle &= 0\\
        \langle d_0, Q(x_0 + \tau_0 d_0)\rangle &= 0\\
        \langle d_0, Qx_0\rangle + \tau_0\langle d_0, Qd_0\rangle &= 0\\
        \tau_0 &= \frac{-\langle d_0, Qx_0\rangle}{\langle d_0, Qd_0\rangle} = \frac{3}{4}\\
    \end{align*}
    also
    \[
        x_1 = x_0 + \tau_0 d_0 = \begin{pmatrix}
            -\frac{1}{4}\\
            -1
        \end{pmatrix}
    \]
    Note $Q \in \mathbb{S}_{++}(2)$ which can be shown by calculating the eigenvalues of $Q$.
    \begin{align*}
        \det(Q - \lambda I) &= 0\\
        \det\begin{pmatrix}
            4 - \lambda & -1\\
            -1 & 1 - \lambda\\
        \end{pmatrix} &= 0\\
        (4 - \lambda)(1 - \lambda) - 1 &= 0\\
        \lambda &= \frac{5 \pm \sqrt{13}}{2} > 0
    \end{align*}
    We can find an optimal solution by using the conjugate direction method
    given two $Q$-conjugate directions $d_0$ and $d_1$
    i.e. $\langle d_0, Qd_1\rangle = 0$. 
    Let $d_1 = \begin{pmatrix}
        a\\
        b
    \end{pmatrix}
    $ we have
    \begin{align*}
        \begin{pmatrix}
            a & b
        \end{pmatrix}
        \begin{pmatrix}
            4 & -1\\
            -1 & 1\\
        \end{pmatrix}
        \begin{pmatrix}
            1\\
            0    
        \end{pmatrix} &= 0 \\
        \begin{pmatrix}
            a & b
        \end{pmatrix}
        \begin{pmatrix}
            4\\
            -1    
        \end{pmatrix} &= 0 \\
        4a &= b
    \end{align*}
    $d_1$ has unit length i.e. $a^2 + b^2 = 1$.
    Therefore, $a = \frac{1}{\sqrt{17}}$ and $b = \frac{4}{\sqrt{17}}$.
    We have $d_1 = \begin{pmatrix}
        \frac{1}{\sqrt{17}}\\
        \frac{4}{\sqrt{17}}
    \end{pmatrix}$.
\end{homeworkProblem}
\begin{homeworkProblem}
    $(\lambda, v)$ is an eigen pair of $M^{-1}A$ i.e.
    \begin{align*}
        M^{-1}Av &= \lambda v\\
        MM^{-1}Av &= \lambda Mv\\
        IAv &= \lambda Mv\\
        Av &= \lambda EE^\top v\\
        E^{-1}Av &= \lambda E^{-1}EE^\top v\\
        E^{-1}Av &= \lambda IE^\top v\\
        E^{-1}Av &= \lambda E^\top v\\
    \end{align*}
    Let $\hat{v} = E^\top v$ which $v = E^{-\top}\hat{v}$.
    Subsititue $v$ in the above equation, we have
    \begin{align*}
        E^{-1}AE^{-\top}\hat{v} &= \lambda E^\top E^{-\top}\hat{v}\\
        E^{-1}AE^{-\top}\hat{v} &= \lambda I\hat{v}\\
        E^{-1}AE^{-\top}\hat{v} &= \lambda \hat{v}\\
    \end{align*}
    Therefore, $(\lambda, \hat{v})$ is an eigen pair of $E^{-1}AE^{-\top}$.
\end{homeworkProblem}
\end{document}
